create database QLCHTL
use [QLCHTL]
CREATE TABLE KHACHHANG
(
	MAKH NCHAR(30),
	TENKH NVARCHAR(50),
	DIACHI NVARCHAR(50),
	DIENTHOAI CHAR(11),
	MK CHAR(20),
	DIEMTHANHVIEN FLOAT,
	
	CONSTRAINT PR_KHACHHANG PRIMARY KEY (MAKH)
)
CREATE TABLE NHACUNGCAP
(
	MANCC NCHAR(30) PRIMARY KEY,
	TENNCC NVARCHAR(50),
	DIACHI NVARCHAR(50),
	DIENTHOAI CHAR(11),
	GHICHU NVARCHAR(1000)
)
CREATE TABLE BOPHAN
(
	MABP NCHAR(30)NOT NULL,
	TENBP NVARCHAR(50),
	GHICHU NVARCHAR (1000),

	CONSTRAINT PR_BOPHAN PRIMARY KEY(MABP)
)
CREATE TABLE NHANVIEN
(
	MANV NCHAR(30) NOT NULL,
	TENNV NVARCHAR(50),
	MABP NCHAR(30),
	NGAYSINH DATE CHECK(NGAYSINH<GETDATE()),
	NGAYLAMVIEC DATE,
	DCHI NVARCHAR(50),
	DIENTHOAI CHAR(11),
	LUONGCOBAN INT,
	MK CHAR(20),

	CONSTRAINT PR_NHANVIEN PRIMARY KEY(MANV),
	CONSTRAINT FK_NHANVIEN_BOPHAN FOREIGN KEY(MABP) REFERENCES BOPHAN(MABP)
)
CREATE TABLE LOAIHANG
(
	MALH NCHAR(30) NOT NULL,
	TENLH NVARCHAR(50),
	GHICHU NVARCHAR(1000),

	CONSTRAINT PR_LOAIHANG PRIMARY KEY(MALH)
)
CREATE TABLE HANGHOA
(
	MAHH NCHAR(30) NOT NULL,
	TENHH NVARCHAR(50),
	DVT NVARCHAR(20),
	DONGIA FLOAT,
	MALH NCHAR(30) NOT NULL,
	MANCC NCHAR(30) NOT NULL,
	SOLUONG INT,
	TINHTRANG NCHAR(10) check(TINHTRANG= N'CÒN HÀNG' OR TINHTRANG= N'HẾT HÀNG'),


	CONSTRAINT PR_HANGHOA PRIMARY KEY(MAHH),
	CONSTRAINT FK_HANGHOA_LOAIHANG FOREIGN KEY(MALH) REFERENCES LOAIHANG(MALH),
	CONSTRAINT FK_HANGHOA_NCC FOREIGN KEY(MANCC) REFERENCES NHACUNGCAP(MANCC)
)
CREATE TABLE KHO
(
	MAKHO NCHAR(30) NOT NULL,
	TENKHO NVARCHAR(50),
	GHICHU NVARCHAR(1000),

	CONSTRAINT PR_KHO PRIMARY KEY(MAKHO)
)
CREATE TABLE PHIEUXUAT
(
	MAPX NCHAR(30),
	NGAYLAP DATE,
	MANV NCHAR(30),
	MAKH NCHAR(30),
	MAKHO NCHAR(30),
	GHICHU NVARCHAR(1000),

	CONSTRAINT PR_PHIEUXUAT PRIMARY KEY(MAPX),
	CONSTRAINT FR_PHIEUXUAT_NHANVIEN FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV),
	CONSTRAINT FR_PHIEUXUAT_KHACHHANG FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH),
	CONSTRAINT FR_PHIEUXUAT_KHO FOREIGN KEY(MAKHO) REFERENCES KHO(MAKHO)
)
CREATE TABLE CTPHIEUXUAT
(
	MAPX NCHAR(30),
	MAHH NCHAR(30),
	SOLUONG INT,
	DONGIA FLOAT,
	GHICHU NVARCHAR(1000),
	DVT NVARCHAR(50),

	CONSTRAINT PR_CTPHIEUXUAT PRIMARY KEY (MAPX, MAHH),
	CONSTRAINT FR_CTPHIEUXUAT_PHIEUXUAT FOREIGN KEY(MAPX) REFERENCES PHIEUXUAT(MAPX),
	CONSTRAINT FR_PHIEUXUAT_HANGHOA FOREIGN KEY(MAHH) REFERENCES HANGHOA(MAHH)

)
CREATE TABLE PHIEUNHAP
(
	MAPN NCHAR(30),
	NGAYNHAPKHO DATE,
	MANV NCHAR(30),
	MAKHO NCHAR(30),
	GHICHU NVARCHAR(1000),

	CONSTRAINT PR_PHIEUNHAP PRIMARY KEY(MAPN),
	CONSTRAINT FR_PHIEUNHAP_NHANVIEN FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV),
	CONSTRAINT FR_PHIEUNHAP_KHO FOREIGN KEY(MAKHO) REFERENCES KHO(MAKHO)
)
CREATE TABLE CTPHIEUNHAP
(
	MAPN NCHAR(30),
	MAHH NCHAR(30),
	SOLUONG INT,
	DONGIA FLOAT,
	DVT NVARCHAR(50),
	GHICHU NVARCHAR(1000),

	CONSTRAINT PR_CTPHIEUNHAP PRIMARY KEY (MAPN, MAHH),
	CONSTRAINT FR_CTPHIEUNHAP_PHIEUNHAP FOREIGN KEY(MAPN) REFERENCES PHIEUNHAP(MAPN),
	CONSTRAINT FR_PHIEUNHAP_HANGHOA FOREIGN KEY(MAHH) REFERENCES HANGHOA(MAHH)
)
CREATE TABLE HOADON
(
	MAHD NCHAR(10) NOT NULL PRIMARY KEY,
	NGAYBAN DATE,
	MANV NCHAR(30),
	MAKH NCHAR(30),
	THANHTOAN FLOAT,

	CONSTRAINT FK_HOADON_KHACHHANG FOREIGN KEY(MAKH) REFERENCES KHACHHANG(MAKH),
	CONSTRAINT FK_HOADON_NHANVVIEN FOREIGN KEY(MANV) REFERENCES NHANVIEN(MANV)
)
CREATE TABLE CHITIETHD
(
	MAHD NCHAR(10) NOT NULL,
	MAHH NCHAR(30) NOT NULL,
	SOLUONG INT,
	DONGIA INT,
	CONSTRAINT PR_CTHD PRIMARY KEY(MAHD,MAHH),
	CONSTRAINT FK_CTHD_HANGHOA FOREIGN KEY(MAHH) REFERENCES HANGHOA(MAHH),  
	CONSTRAINT FK_CTHD_HD FOREIGN KEY(MAHD) REFERENCES HOADON(MAHD)
) 
INSERT INTO BOPHAN(MABP,TENBP,GHICHU)
VALUES
('BP01',N'Quản lý',null),
('BP02',N'Nhân viên',null),
('BP03',N'Thu ngân',null),
('BP04',N'Bảo vệ',null),
('BP05',N'Quản lý kho',null)

INSERT INTO KHACHHANG
VALUES 
('KH001',N'NGUYỄN CÔNG TẤN',N'155 CẦU KINH PHƯỜNG TÂN TẠO A QUẬN BÌNH TÂN','0932710237','123',0),
('KH002',N'NGÔ KHIÊM',N'200 MỸ AN BÀ RỊA VŨNG TÀU','0903213721','123',0),
('KH003',N'NGÔ HOÀNG THIÊN TUỆ',N'VÕ VĂN KIỆT QUẬN 1','0234253874','123',0),
('KH005',N'NGUYỄN THÀNH NHÂN',N'THÀNH PHỐ TÂY NINH','0988338330','123',0),
('KH006',N'TRƯƠNG CÔNG HẬU',N'THÀNH PHỐ TÂY NINH','0124129400','123',0),
('KH007',N'TRẦN THỊ ANH THƯ',N'LAGI BÌNH THUẬN','0898749270','123',0),
('KH008',N'NGUYỄN THANH  QUANG',N'QUẬN 11 THÀNH PHỐ HỒ CHÍ MINH','0903213722','123',0),
('KH009',N'NGUYỄN HUỲNH HUY',N'BẾN TRE','0128393933','123',0),
('KH010',N'NGÔ GIA TRÍ',N'198 MỸ AN BÀ RỊA VŨNG TÀU','0903213799','123',0),
('KH011',N'NGÔ HUY THẮNG','169 ĐỨC HÒA LONG AN','0933392322','123',0)
SET DATEFORMAT DMY
INSERT INTO NHANVIEN(MANV,TENNV,MABP,NGAYSINH,NGAYLAMVIEC,DCHI ,DIENTHOAI,LUONGCOBAN,MK)
VALUES 
('NV001',N'VÕ THÀNH CÔNG','BP01','10/03/1975','15/03/2010',N'THÀNH PHỐ HỒ CHÍ MINH','0127234980',1150000,'123'),
('NV002',N'BÙI THÁI BẢO','BP02','21/06/2000','25/07/2016',N'THÀNH PHỐ HỒ CHÍ MINH','0906239810',1550000,'123'),
('NV003',N'TRẦN THÀNH ĐẠT','BP03','15/09/2001','10/10/2018',N'THÀNH PHỐ BẾN TRE','0209384099',1800000,'123'),
('NV004',N'NGUYỄN MINH TRÍ','BP04','03/09/1999','20/11/2015',N'THÀNH PHỐ HỒ CHÍ MINH','0977998448',2500000,'123'),
('NV005',N'NGÔ BÌNH MINH','BP05','22/10/1998','20/07/2017',N'BẾN TRE','0977467446',1600000,'123')
INSERT INTO NHACUNGCAP
VALUES 
('NCC001',N'CÔNG TY COCACOLA VIỆT NAM','TPHCM','1800 1999',null),
('NCC002',N'CÔNG TY TNHH THỰC PHẨM PEPSICO VIỆT NAM',N'Bình Dương','1800 2828',null),
('NCC003',N'CÔNG TY NESTLE VIỆT NAM',N'ĐỒNG NAI','1800 6699',null),
('NCC004',N'CÔNG TY MERINO',N'Thành phố Hồ Chí Minh','1800 1212',null),
('NCC005',N'CÔNG TY VINAMILK VIỆT NAM',N' quận 7, Tp. HCM','1800 9899',null),
('NCC006',N'CÔNG TY Đồ Dùng Gia Đình Việt Nam',N' Thuận An, Bình Dương','1800 1122',null),
('NCC007',N'CÔNG TY TNHH XUẤT KHẨU TRÁI CÂY NHIỆT ĐỚI',N'Châu Thành, Bến Tre','1800 1315',null),
('NCC008',N'CÔNG TY Cổ phần Masan',N'Quận 1, Tp. Hồ Chí Minh','1800 8855',null),
('NCC009',N'CÔNG TY TNHH THUỐC LÁ SÀI GÒN',N'Khu công nghiệp Vĩnh Lộc, Huyện Bình Chánh','1800 0099',null),
('NCC010',N'CÔNG TY TNHH GIA LÊ NGUYÊN',N'Quận 04, Tp. Hồ Chí Minh','1800 0908',null)
INSERT INTO LOAIHANG(MALH,TENLH,GHICHU)
VALUES
('LH001',N'Nước uống',null),
('LH002',N'Thức ăn',null),
('LH003',N'Nước uống có ga',null),
('LH004',N'Nước uống nóng',null),
('LH005',N'Đồ dùng',null),
('LH006',N'Học tập',null),
('LH007',N'Thức ăn lạnh',null),
('LH008',N'Thức ăn nóng',null),
('LH009',N'Vệ sinh',null),
('LH010',N'Y tế',null),
('LH011',N'Gia Vị',null)
INSERT INTO HANGHOA(MAHH,TENHH,DVT,DONGIA,MALH,MANCC,SOLUONG,TINHTRANG)
VALUES
('HH001',N'Coca-Cola','Lon',8000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH002',N'Coca-ColaLight','Lon',10000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH003',N'Coke Zero','Lon',20000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH004',N'Sprite','Lon',8000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH005',N'Fanta','Lon',8000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH006',N'Minuti Maid Nutriboost','Lon',10000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH007',N'Minuti Maid Teppy','Lon',10000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH008',N'Schweppes','Lon',8000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH009',N'Aquarius','Chai',8000,'LH003','NCC001',1000,N'CÒN HÀNG'),
('HH010',N'Pepsi Cola','Lon',8000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH011',N'Sting','Lon',10000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH012',N'Mountian Dew','Lon',8000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH013',N'Tropicana Twister','Lon',9000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH014',N'7Up','Lon',8000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH015',N'7Up Revive','Lon',10000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH016',N'Ô Long Tea+','Lon',10000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH017',N'Mirinda','Lon',8000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH018',N'Lipton Teas','Lon',8000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH019',N'Aquafina','Chai',8000,'LH003','NCC002',1000,N'CÒN HÀNG'),
('HH020',N'KitKat','Hộp',35000,'LH002','NCC003',1000,N'CÒN HÀNG'),
('HH021',N'Milo','Hộp',56000,'LH002','NCC003',1000,N'CÒN HÀNG'),
('HH022',N'KoKo Krunch','Hộp',50000,'LH002','NCC003',1000,N'CÒN HÀNG'),
('HH023',N'Corn Flakes ','Hộp',48000,'LH002','NCC003',1000,N'CÒN HÀNG'),
('HH024',N'Cà Phê NesCaFe','Hộp',70000,'LH002','NCC003',1000,N'CÒN HÀNG'),
('HH025',N'Kem Milo','Gói',11000,'LH007','NCC003',1000,N'CÒN HÀNG'),
('HH026',N'Kem Kitkat','Gói',12000,'LH007','NCC003',1000,N'CÒN HÀNG'),
('HH027',N'Sữa chua Nestle','Hộp',8000,'LH007','NCC003',1000,N'CÒN HÀNG'),
('HH028',N'Sữa Nestle','Hộp',8000,'LH007','NCC003',1000,N'CÒN HÀNG'),
('HH029',N'Bột nêm Nestle','Gói',8000,'LH011','NCC003',1000,N'CÒN HÀNG'),
('HH030',N'Dầu hào Nestle','Chai',8000,'LH011','NCC003',1000,N'CÒN HÀNG'),
('HH031',N'Nước tương Nestle','Chai',8000,'LH011','NCC003',1000,N'CÒN HÀNG'),
('HH032',N'Nước Mắm Nestle','Chai',8000,'LH011','NCC003',1000,N'CÒN HÀNG'),
('HH033',N'Kem Merino Sầu riêng sữa dừa','Hộp',69000,'LH007','NCC004',1000,N'CÒN HÀNG'),
('HH034',N'Kem Merino socola vani','Hộp',71000,'LH007','NCC004',1000,N'CÒN HÀNG'),
('HH035',N'Kem Merino khoai môn','Hộp',69000,'LH007','NCC004',1000,N'CÒN HÀNG'),
('HH036',N'Kem Merino đậu xanh sữa dừa','Hộp',69000,'LH007','NCC004',1000,N'CÒN HÀNG'),
('HH037',N'Sữa Vinamilk','Thùng',300000,'LH001','NCC005',1000,N'CÒN HÀNG'),
('HH038',N'Sữa chua Vinamilk','Hộp',9000,'LH007','NCC005',1000,N'CÒN HÀNG'),
('HH039',N'Sữa Vinamilk không đường','Hộp',9000,'LH007','NCC005',1000,N'CÒN HÀNG'),
('HH040',N'Sữa Vinamilk','Gói',6000,'LH007','NCC005',1000,N'CÒN HÀNG')
INSERT INTO KHO(MAKHO,TENKHO,GHICHU)
VALUES
('K001','Kho 1', null),
('K002','Kho 2', null),
('K003','Kho 3', null),
('K004','Kho 4', null)
SET DATEFORMAT DMY
INSERT INTO PHIEUXUAT(MAPX,NGAYLAP,MANV,MAKH,MAKHO,GHICHU)
VALUES
('PX001','10/03/2021','NV001','KH001','K001',NULL),
('PX002','10/04/2021','NV001','KH002','K001',NULL),
('PX003','10/05/2021','NV001','KH003','K001',NULL),
('PX004','10/05/2021','NV001','KH001','K001',NULL),
('PX005','10/05/2021','NV001','KH002','K001',NULL)
INSERT INTO CTPHIEUXUAT(MAPX,MAHH,SOLUONG,DONGIA,GHICHU,DVT)
VALUES
('PX001','HH001',10,150000,NULL,N'Thùng'),
('PX002','HH002',15,300000,NULL,N'Thùng'),
('PX003','HH003',15,300000,NULL,N'Thùng'),
('PX004','HH004',12,300000,NULL,N'Thùng'),
('PX005','HH005',16,300000,NULL,N'Thùng')
SET DATEFORMAT DMY
INSERT PHIEUNHAP(MAPN,NGAYNHAPKHO,MANV,MAKHO,GHICHU)
VALUES
('PN001','10/03/2021','NV001','K001',NULL),
('PN002','10/04/2021','NV001','K001',NULL),
('PN003','10/05/2021','NV001','K001',NULL),
('PN004','10/05/2021','NV001','K001',NULL),
('PN005','10/05/2021','NV001','K001',NULL)
INSERT INTO CTPHIEUNHAP(MAPN,MAHH,SOLUONG,DONGIA,DVT,GHICHU)
VALUES
('PN001','HH001',10,150000,N'Thùng',NULL),
('PN002','HH002',15,300000,N'Thùng',NULL),
('PN003','HH003',15,300000,N'Thùng',NULL),
('PN004','HH004',12,300000,N'Thùng',NULL),
('PN005','HH005',16,300000,N'Thùng',NULL)
SET DATEFORMAT DMY
INSERT INTO HOADON(MAHD,NGAYBAN,MANV,MAKH,THANHTOAN)
VALUES
('HD001','10/03/2021','NV001','KH001',460000),
('HD002','10/04/2021','NV001','KH002',600000),
('HD003','10/05/2021','NV001','KH003',78000),
('HD004','10/05/2021','NV001','KH001',126000),
('HD005','10/05/2021','NV001','KH002',400000)
INSERT INTO CHITIETHD(MAHD,MAHH,SOLUONG,DONGIA)
VALUES
('HD001','HH001',10,80000),
('HD001','HH002',10,100000),
('HD001','HH003',10,200000),
('HD001','HH004',10,80000),
('HD002','HH003',30,600000)